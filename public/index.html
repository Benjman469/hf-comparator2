<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Comparaison Hauts Faits WoW</title>
<style>
  /* Ton CSS ici, inchang√© */
  body {
    background: url('https://i.imgur.com/rAa3098.png') no-repeat center center fixed;
    background-size: cover;
    margin: 0; padding: 40px;
    font-family: 'IM Fell English SC', serif;
    color: #ffd700;
    text-shadow: 2px 2px 5px #000;
    text-align: center;
  }
  .comparison {
    display: flex;
    gap: 50px;
    margin: 20px auto;
    justify-content: center;
  }
  .character {
    background: rgba(0, 0, 0, 0.6);
    padding: 15px 25px;
    border-radius: 8px;
    width: 200px;
    text-align: center;
  }
  .name {
    font-size: 24px;
    font-weight: bold;
    margin-bottom: 15px;
    color: #ffd700;
    text-shadow: 1px 1px 4px #000;
  }
  .hf-points {
    font-size: 32px;
    font-weight: bold;
    color: #ffa500;
  }
  .winner {
    margin-top: 30px;
    font-size: 28px;
    font-weight: bold;
    color: #ffff00;
    text-shadow: 2px 2px 5px #000;
  }
  .difference-text {
    margin-top: 10px;
    font-size: 18px;
    color: #ffd700;
    text-shadow: 1px 1px 3px #000;
  }
  #playBtn {
    display: none; /* Cach√© par d√©faut */
    margin: 25px auto;
    padding: 10px 20px;
    font-size: 18px;
    cursor: pointer;
    border: none;
    border-radius: 8px;
    background-color: #ffa500;
    color: #000;
    font-weight: bold;
    box-shadow: 1px 1px 5px #000;
  }
  #playBtn:hover {
    background-color: #ffcc33;
  }
</style>
</head>
<body>

  <h1>Comparaison Hauts Faits WoW</h1>

  <div class="comparison">
    <div class="character" id="char1">
      <div class="name">Benjman</div>
      <div class="hf-points" id="points1">‚Äî</div>
    </div>
    <div class="character" id="char2">
      <div class="name">Percevent</div>
      <div class="hf-points" id="points2">‚Äî</div>
    </div>
  </div>
  <div class="winner" id="winner"></div>
  <div class="difference-text" id="diffText"></div>

  <button id="playBtn">Jouer le d√©fouraillage</button>

  <audio id="bgMusic" preload="auto">
    <source src="https://github.com/Benjman469/mp3-hosting/raw/refs/heads/main/Benjman%20va%20bient%C3%B4t%20d%C3%A9fourailler%20le%20recor%20(2).mp3" type="audio/mp3" />
    Votre navigateur ne supporte pas la balise audio.
  </audio>

  <script>
    console.log('Script JS charg√©');

    async function fetchHFPoints(char1, char2, realm = 'Archimonde', region = 'EU') {
      const baseURL = '/api';
      const url = `${baseURL}/compare?char1=${encodeURIComponent(char1)}&char2=${encodeURIComponent(char2)}&realm=${encodeURIComponent(realm)}&region=${encodeURIComponent(region)}`;
      try {
        const res = await fetch(url);
        if (!res.ok) throw new Error(`Erreur HTTP ${res.status}`);
        const data = await res.json();
        console.log('R√©ponse API:', data);
        return data;
      } catch (err) {
        console.error('Erreur fetch:', err);
        return null;
      }
    }

    async function displayComparison() {
      console.log('displayComparison called');
      const char1 = 'Benjman';
      const char2 = 'Percevent';

      const data = await fetchHFPoints(char1, char2);

      if (!data) {
        console.log('Aucune donn√©e re√ßue.');
        document.getElementById('points1').textContent = 'Erreur';
        document.getElementById('points2').textContent = 'Erreur';
        document.getElementById('winner').textContent = 'Impossible de r√©cup√©rer les donn√©es.';
        document.getElementById('diffText').textContent = '';
        return;
      }

      const points1 = data.characters[0]?.points ?? 'Non trouv√©';
      const points2 = data.characters[1]?.points ?? 'Non trouv√©';

      document.getElementById('points1').textContent = points1;
      document.getElementById('points2').textContent = points2;

      const playBtn = document.getElementById('playBtn');

      if (data.winner === 'Egalit√©') {
        document.getElementById('winner').textContent = 'ü§ù C‚Äôest une √©galit√© parfaite !';
        document.getElementById('diffText').textContent = '';
        playBtn.style.display = 'none';
      } else {
        document.getElementById('winner').textContent = `üèÜ Le vainqueur est : ${data.winner} ! üèÜ`;

        const diff = Math.abs(points1 - points2);
        let leader, challenger;
        if (points1 > points2) {
          leader = char1;
          challenger = char2;
        } else {
          leader = char2;
          challenger = char1;
        }

        document.getElementById('diffText').textContent =
          `${leader} a ${diff} points de HF d'avance, mais ${challenger} va bient√¥t lui d√©fourailler son record !`;

        playBtn.style.display = 'inline-block';
      }
    }

    displayComparison();

    const playBtn = document.getElementById('playBtn');
    const bgMusic = document.getElementById('bgMusic');

    playBtn.addEventListener('click', () => {
      bgMusic.play();
      playBtn.style.display = 'none';
    });
  </script>

</body>
</html>
